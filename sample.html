<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Sales Rep Cheat Sheet</title>
	<style>
    	body {
        	font-family: Arial, sans-serif;
        	line-height: 1.6;
        	margin: 20px;
    	}

    	h1, h2 {
        	color: #2C3E50;
    	}

    	h1 {
        	text-align: center;
    	}

    	.section {
        	margin-bottom: 20px;
        	padding: 15px;
        	border: 1px solid #EAECEE;
        	border-radius: 8px;
        	background: #F9FBFC;
    	}

    	.section.collapsible {
        	cursor: pointer;
    	}

    	.section .content {
        	display: none;
        	margin-top: 10px;
    	}

    	.section.open .content {
        	display: block;
    	}

    	.expand-indicator {
        	float: right;
        	font-size: 1.2em;
        	color: #888;
        	cursor: pointer;
    	}

    	.expand-indicator.open {
        	color: #3498DB;
        	font-weight: bold;
    	}

    	.feedback-dropdown {
        	display: block;
        	width: 100%;
        	padding: 8px;
        	margin-top: 8px;
        	border: 1px solid #CCC;
        	border-radius: 5px;
        	background-color: #FFF;
        	font-size: 1em;
        	color: #333;
    	}

    	.feedback-dropdown:focus {
        	border-color: #3498DB;
        	outline: none;
    	}

		.feedback-container {
			margin-top: 10px;
		}
	</style>
</head>
<body>
	  <h1>
	   Discovery Cheat Sheet
	  </h1>
	  <p id="header" name="seller_email">
	   customer@customer.com
	  </p>
	  <p id="header" name="prospect_email">
	   prospect@prospect.com
	  </p>
	  <p id="header" name="meeting_datetime">
	   2025-01-16T15:30:00+02:00
	  </p>
	<!-- Sections -->
	<div class="section collapsible" id="Summary">
    	<h2>Summary <span class="expand-indicator">+</span></h2>
    	<div class="content" name="summary">
			<div class="feedback-container">
				<label for="feedback-Summary">Feedback: </label>
				<select id="feedback-Summary" class="feedback-dropdown" onchange="updateFeedback('Summary', this.value)">
					<option value="">Not selected</option>
					<option value="Misleading content">Misleading content</option>
					<option value="Not valuable">Not valuable</option>
					<option value="Slightly valuable">Slightly valuable</option>
					<option value="Great content">Great content</option>
					<option value="You have nailed it">You have nailed it</option>
				</select>
			</div>
    	</div>
	</div>

	<div class="section collapsible" id="Notes">
    	<h2>Notes <span class="expand-indicator">+</span></h2>
    	<div class="content" name="notes">
			<div class="feedback-container">
				<label for="feedback-Notes">Feedback: </label>
				<select id="feedback-Notes" class="feedback-dropdown" onchange="updateFeedback('Notes', this.value)">
					<option value="">Not selected</option>
					<option value="Misleading content">Misleading content</option>
					<option value="Not valuable">Not valuable</option>
					<option value="Slightly valuable">Slightly valuable</option>
					<option value="Great content">Great content</option>
					<option value="You have nailed it">You have nailed it</option>
				</select>
			</div>
    	</div>
	</div>

	<div class="section collapsible" id="Icebreakers">
    	<h2>Icebreakers <span class="expand-indicator">+</span></h2>
    	<div class="content" name="icebreakers">
			<div class="feedback-container">
				<label for="feedback-Icebreakers">Feedback: </label>
				<select id="feedback-Icebreakers" class="feedback-dropdown" onchange="updateFeedback('Icebreakers', this.value)">
					<option value="">Not selected</option>
					<option value="Misleading content">Misleading content</option>
					<option value="Not valuable">Not valuable</option>
					<option value="Slightly valuable">Slightly valuable</option>
					<option value="Great content">Great content</option>
					<option value="You have nailed it">You have nailed it</option>
				</select>
			</div>
    	</div>
	</div>

	<div class="section collapsible" id="PainPoints">
    	<h2>Pain Points <span class="expand-indicator">+</span></h2>
    	<div class="content" name="pain_points">
			<div class="feedback-container">
				<label for="feedback-PainPoints">Feedback: </label>
				<select id="feedback-PainPoints" class="feedback-dropdown" onchange="updateFeedback('PainPoints', this.value)">
					<option value="">Not selected</option>
					<option value="Misleading content">Misleading content</option>
					<option value="Not valuable">Not valuable</option>
					<option value="Slightly valuable">Slightly valuable</option>
					<option value="Great content">Great content</option>
					<option value="You have nailed it">You have nailed it</option>
				</select>
			</div>
    	</div>
	</div>

	<div class="section collapsible" id="CompanyResearch">
    	<h2>Company Research <span class="expand-indicator">+</span></h2>
    	<div class="content" name="linkedin_prospect_research">
			<div class="feedback-container">
				<label for="feedback-PainPoints">Feedback: </label>
				<select id="feedback-PainPoints" class="feedback-dropdown" onchange="updateFeedback('CompanyResearch', this.value)">
					<option value="">Not selected</option>
					<option value="Misleading content">Misleading content</option>
					<option value="Not valuable">Not valuable</option>
					<option value="Slightly valuable">Slightly valuable</option>
					<option value="Great content">Great content</option>
					<option value="You have nailed it">You have nailed it</option>
				</select>
			</div>
    	</div>
	</div>

	<div class="section collapsible" id="News">
    	<h2>News <span class="expand-indicator">+</span></h2>
    	<div class="content" name="news_summary">
			<div class="feedback-container">
				<label for="feedback-PainPoints">Feedback: </label>
				<select id="feedback-PainPoints" class="feedback-dropdown" onchange="updateFeedback('News', this.value)">
					<option value="">Not selected</option>
					<option value="Misleading content">Misleading content</option>
					<option value="Not valuable">Not valuable</option>
					<option value="Slightly valuable">Slightly valuable</option>
					<option value="Great content">Great content</option>
					<option value="You have nailed it">You have nailed it</option>
				</select>
			</div>
    	</div>
	</div>

	<div class="section collapsible" id="ValueProposition">
    	<h2>Customized Value Proposition <span class="expand-indicator">+</span></h2>
    	<div class="content" name="customized_value_proposition">
			<div class="feedback-container">
				<label for="feedback-PainPoints">Feedback: </label>
				<select id="feedback-PainPoints" class="feedback-dropdown" onchange="updateFeedback('ValueProposition', this.value)">
					<option value="">Not selected</option>
					<option value="Misleading content">Misleading content</option>
					<option value="Not valuable">Not valuable</option>
					<option value="Slightly valuable">Slightly valuable</option>
					<option value="Great content">Great content</option>
					<option value="You have nailed it">You have nailed it</option>
				</select>
			</div>
    	</div>
	</div>

	<div class="section collapsible" id="RelevantExperience">
    	<h2>Relevant Experience <span class="expand-indicator">+</span></h2>
    	<div class="content" name="relevant_experience">
			<div class="feedback-container">
				<label for="feedback-PainPoints">Feedback: </label>
				<select id="feedback-PainPoints" class="feedback-dropdown" onchange="updateFeedback('RelevantExperience', this.value)">
					<option value="">Not selected</option>
					<option value="Misleading content">Misleading content</option>
					<option value="Not valuable">Not valuable</option>
					<option value="Slightly valuable">Slightly valuable</option>
					<option value="Great content">Great content</option>
					<option value="You have nailed it">You have nailed it</option>
				</select>
			</div>
    	</div>
	</div>

	<div class="section collapsible" id="QualificationQuestions">
    	<h2>Qualification Questions <span class="expand-indicator">+</span></h2>
    	<div class="content" name="qualification_questions">
			<div class="feedback-container">
				<label for="feedback-PainPoints">Feedback: </label>
				<select id="feedback-PainPoints" class="feedback-dropdown" onchange="updateFeedback('QualificationQuestions', this.value)">
					<option value="">Not selected</option>
					<option value="Misleading content">Misleading content</option>
					<option value="Not valuable">Not valuable</option>
					<option value="Slightly valuable">Slightly valuable</option>
					<option value="Great content">Great content</option>
					<option value="You have nailed it">You have nailed it</option>
				</select>
			</div>
    	</div>
	</div>

	<div class="section collapsible" id="RecommendedProducts">
    	<h2>Recommended Products <span class="expand-indicator">+</span></h2>
    	<div class="content" name="recommended_product">
			<div class="feedback-container">
				<label for="feedback-PainPoints">Feedback: </label>
				<select id="feedback-PainPoints" class="feedback-dropdown" onchange="updateFeedback('RecommendedProducts', this.value)">
					<option value="">Not selected</option>
					<option value="Misleading content">Misleading content</option>
					<option value="Not valuable">Not valuable</option>
					<option value="Slightly valuable">Slightly valuable</option>
					<option value="Great content">Great content</option>
					<option value="You have nailed it">You have nailed it</option>
				</select>
			</div>
    	</div>
	</div>

	<div class="section collapsible" id="ObjectionHandling">
    	<h2>Objection Handling <span class="expand-indicator">+</span></h2>
    	<div class="content" name="handling_objection">
			<div class="feedback-container">
				<label for="feedback-PainPoints">Feedback: </label>
				<select id="feedback-PainPoints" class="feedback-dropdown" onchange="updateFeedback('ObjectionHandling', this.value)">
					<option value="">Not selected</option>
					<option value="Misleading content">Misleading content</option>
					<option value="Not valuable">Not valuable</option>
					<option value="Slightly valuable">Slightly valuable</option>
					<option value="Great content">Great content</option>
					<option value="You have nailed it">You have nailed it</option>
				</select>
			</div>
    	</div>
	</div>

	<div class="section collapsible" id="RelevantTechStack">
    	<h2>Relevant Tech Stack <span class="expand-indicator">+</span></h2>
    	<div class="content" name="relevant_techstack">
			<div class="feedback-container">
				<label for="feedback-PainPoints">Feedback: </label>
				<select id="feedback-PainPoints" class="feedback-dropdown" onchange="updateFeedback('RelevantTechStack', this.value)">
					<option value="">Not selected</option>
					<option value="Misleading content">Misleading content</option>
					<option value="Not valuable">Not valuable</option>
					<option value="Slightly valuable">Slightly valuable</option>
					<option value="Great content">Great content</option>
					<option value="You have nailed it">You have nailed it</option>
				</select>
			</div>
    	</div>
	</div>

	<div class="section collapsible" id="FundingRound">
    	<h2>Funding Round <span class="expand-indicator">+</span></h2>
    	<div class="content" name="fundings">
			<div class="feedback-container">
				<label for="feedback-PainPoints">Feedback: </label>
				<select id="feedback-PainPoints" class="feedback-dropdown" onchange="updateFeedback('FundingRound', this.value)">
					<option value="">Not selected</option>
					<option value="Misleading content">Misleading content</option>
					<option value="Not valuable">Not valuable</option>
					<option value="Slightly valuable">Slightly valuable</option>
					<option value="Great content">Great content</option>
					<option value="You have nailed it">You have nailed it</option>
				</select>
			</div>
    	</div>
	</div>

	<!-- JavaScript -->
	<script>
		// Object to store feedback selections
		let feedbackSelections = {};
		const currentUrl = window.location.href;
		const url = "https://script.google.com/macros/s/AKfycbxDiMlipL6p6Xqou6uKOEErASx51sPwyB1BZ_xQX5cbuqYKO5dgi6OZZ26RtTEIo38/exec";
		
		function sendPageLoadData() {
			// Get the values of seller_email and prospect_email from the HTML elements
			const sellerEmail = document.querySelector('[name="seller_email"]').innerText.trim();
			const prospectEmail = document.querySelector('[name="prospect_email"]').innerText.trim();

			// Prepare the data to be sent
			const dataToSend = {
				seller_email: sellerEmail,
				prospect_email: prospectEmail,
				docURL: currentUrl
				// Do not include feedbackSelections here
			};

			// Send the data to the backend (Google Apps Script)
			fetch(url, {
				method: "POST",
				mode: "no-cors",  // Enable CORS mode
				headers: {
					"Content-Type": "application/json"
				},
				body: JSON.stringify(dataToSend) // Send the seller_email and prospect_email data
			})
			.then(response => response.text())
			.then(data => console.log("Data sent successfully:", data))
			.catch(error => console.error("Error sending data:", error));
		}

		function sendFeedbackToGoogleSheet() {
			// Get seller_email and prospect_email values from the HTML page
			const sellerEmail = document.querySelector('[name="seller_email"]').innerText.trim();
			const prospectEmail = document.querySelector('[name="prospect_email"]').innerText.trim();

			// Add seller_email and prospect_email to the feedbackSelections object
			const feedbackSelectionsWithEmails = {
				...feedbackSelections,  // Existing feedback selections
				seller_email: sellerEmail,
				prospect_email: prospectEmail,
				docURL: currentUrl
			};

			fetch(url, {
				method: "POST",
				mode: "no-cors",  // Enable CORS mode
				headers: { "Content-Type": "application/json" },
				body: JSON.stringify(feedbackSelectionsWithEmails), // Send updated data
			})
			.then(response => response.text())
			.then(data => console.log("Feedback stored:", data))
			.catch(error => console.error("Errorsss saving feedback:", error));
		}	

		// Function to update feedback for each section and log all selections
		function updateFeedback(sectionId, selectedValue) {
			feedbackSelections[sectionId] = selectedValue;
			
			// Log all selections in the console
			console.clear(); // Clears previous logs for better visibility
			console.log("Updated Feedback Selections:");
			console.table(feedbackSelections); // Display in table format for readability
			sendFeedbackToGoogleSheet();
		}

		// Function to get all feedback selections
		function getAllFeedback() {
			console.log("All Feedback Selections:", feedbackSelections);
			return feedbackSelections;
		}

		// Ensure collapsible behavior is working
		document.querySelectorAll('.collapsible').forEach(section => {
			section.querySelector('h2').addEventListener('click', function () {
				section.classList.toggle('open');
				const indicator = section.querySelector('.expand-indicator');
				if (indicator) {
					indicator.textContent = section.classList.contains('open') ? '-' : '+';
				}
			});
		});
		window.onload = sendPageLoadData; 
	</script>
</body>
</html>
